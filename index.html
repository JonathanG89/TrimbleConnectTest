<!DOCTYPE html>
<html>
<head>
	<title>My JavaScript Project</title>
</head>
<body>
	
	<!-- <iframe src="https://jonathang89.github.io/TrimbleConnectTest/script.js"></iframe> -->
	<script>
		window.onload = (event) => {
  			getData();
		};
		
		async function getData() {
			API = await TrimbleConnectWorkspace.connect(window.parent, (event, data) => {
				console.log("Event: ", event, data);
			});
			
			API.project.getProject().then(project => {
				console.log(project); // Trimble Connect project details
			});
			
			
			const axios = require('axios');
			const accessToken = 'your-access-token';
			const workspaceId = 'your-workspace-id';

			axios.get(`https://tc-api.trimble.com/api/nodes?includeProperties=true&workspaceId=${workspaceId}`, {
			  headers: {
			    Authorization: `Bearer ${accessToken}`,
			  },
			})
			  .then((response) => {
			    const nodes = response.data.nodes;
			    nodes.forEach((node) => {
			      console.log(`Node: ${node.name}`);
			      console.log(`Properties: ${JSON.stringify(node.properties)}`);
			    });
			  })
			  .catch((error) => {
			    console.error(error);
			  });
		}
	</script>

	<script src="https://components.connect.trimble.com/trimble-connect-workspace-api/index.js"></script>
	
</body>
</html>
