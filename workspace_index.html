<!DOCTYPE html>
<html>
<head>
	<title>My JavaScript Project</title>
</head>
  <body>
  
	  <script type="text/javascript" src="https://components.connect.trimble.com/trimble-connect-workspace-api/index.js"></script>
	  	  
	  <script type="text/javascript">
		
		console.log("Test Log");
		
		getData();
		  
		async function getData() {
			this.API = await WorkspaceAPI.connect(
			  window.parent,
			  (event, args) => {
			    switch (event) {
			      case "extension.command":
			      //"Command executed by the user: args.data"
				break;
			      case "extension.accessToken":
			      //"Accestoken or status: args.data"
				break;
			      case "extension.userSettingsChanged":
			      //"User settings changed!"
				break;
			      default:
			    }
			  },
			  30000
			);

			console.log(this.API);
		}
		  
		//Request for the access token.
		this.API.extension.getPermission("accesstoken").then((accessToken) => {
		    //Current user access token or status: accessToken
		    console.log(accesstoken);
		});
	  </script>
    
  </body>
</html>
